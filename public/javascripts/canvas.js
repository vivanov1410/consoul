// Generated by CoffeeScript 1.3.3
(function() {

  $(function() {
    var JavaScriptMode, editor;
    editor = ace.edit("editor");
    editor.renderer.setShowPrintMargin(false);
    editor.getSession().setUseSoftTabs(true);
    JavaScriptMode = require("ace/mode/javascript").Mode;
    editor.getSession().setMode(new JavaScriptMode());
    return sharejs.open('hello', 'text', function(error, doc) {
      var updatePreview;
      doc.attach_ace(editor);
      editor.getSession().setValue('<!DOCTYPE HTML>\n<html>\n  <head>\n    <style>\n      body {\n        margin: 0px;\n        padding: 0px;\n      }\n      canvas {\n        border: 1px solid #9C9898;\n      }\n    </style>\n    <script>\n      window.onload = function() {\n        var canvas = document.getElementById(\'canvas\');\n        if (canvas && canvas.getContext) {\n          var ctx = canvas.getContext("2d");\n          if (ctx) {\n            ctx.fillStyle = "lightGray";\n            ctx.fillRect(0,0, ctx.canvas.width, ctx.canvas.height);\n          }\n        }\n      };\n\n    </script>\n  </head>\n  <body>\n    <canvas id="canvas">\n      WOW! Back off! This browser doesn\'t support canvas\n    </canvas>\n  </body>\n</html>');
      updatePreview = function() {
        var preview, previewFrame;
        previewFrame = document.getElementById('preview');
        preview = previewFrame.contentDocument || previewFrame.contentWindow.document;
        preview.open();
        console.log(editor.getSession().getValue());
        preview.write(editor.getSession().getValue());
        return preview.close();
      };
      return editor.getSession().on('change', function(e) {
        return updatePreview();
      });
    });
  });

}).call(this);
